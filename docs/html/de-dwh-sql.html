<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.26">
<title>Project: Data Warehouse with PostgreSQL</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock pre>code{display:block}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Project: Data Warehouse with PostgreSQL</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_preparing_the_environment">Preparing the environment</a></li>
<li><a href="#_documentation">Documentation</a>
<ul class="sectlevel2">
<li><a href="#_building_the_documentation">Building the documentation</a></li>
<li><a href="#_diagram_support">Diagram support</a></li>
<li><a href="#_ocr_image_text_extraction_support">OCR image text extraction support</a>
<ul class="sectlevel3">
<li><a href="#_preparing_the_specifications_table">Preparing the specifications table</a></li>
<li><a href="#_preparing_the_etl_mindmap">Preparing the ETL mindmap</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_data_architecture">Data architecture</a>
<ul class="sectlevel2">
<li><a href="#_etl_task_breakdown">ETL task breakdown</a></li>
<li><a href="#_specifications">Specifications</a></li>
<li><a href="#_data_flow">Data Flow</a></li>
</ul>
</li>
<li><a href="#_pipeline">Pipeline</a></li>
<li><a href="#_bronze_layer">Bronze layer</a></li>
<li><a href="#_silver_layer">Silver layer</a>
<ul class="sectlevel2">
<li><a href="#_data_integration_analysis_and_sketch">Data integration analysis and sketch</a></li>
<li><a href="#_coding_the_transformations">Coding the transformations</a>
<ul class="sectlevel3">
<li><a href="#_crm_customer_info_table">CRM customer info table</a></li>
<li><a href="#_crm_product_info_and_sales_tables">CRM product info and sales tables</a></li>
<li><a href="#_erp_tables">ERP tables</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_gold_layer">Gold layer</a></li>
<li><a href="#data_catalog">The Data Catalog (gold layer)</a>
<ul class="sectlevel2">
<li><a href="#_overview">Overview</a></li>
<li><a href="#_gold_dim_customers">gold.dim_customers</a>
<ul class="sectlevel3">
<li><a href="#_known_countries">Known countries</a></li>
</ul>
</li>
<li><a href="#_gold_dim_products">gold.dim_products</a></li>
<li><a href="#_gold_facts_sales">gold.facts_sales</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_preparing_the_environment">Preparing the environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This project uses Linux on Pop_OS!, with PostgreSQL as the database management system for the data warehouse.</p>
</div>
<div class="paragraph">
<p>Before running the data warehouse scripts, ensure that you have PostgreSQL installed and running on your system.
You will also need to have access to the PostgreSQL user with sufficient privileges to create databases and tables.
Currently, the scripts assume that the PostgreSQL user is <code>postgres</code>.</p>
</div>
<div class="paragraph">
<p>To install PostgreSQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo apt install postgresql</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the service will start automatically after installation.
If it does not, you can start it manually using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo service postgresql start</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_documentation">Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The project documentation is written in AsciiDoc.
If you want to modify and rebuild the documentation, you will need Asciidoctor.
The method I used to install asciidoctor was to install the latest Ruby gems:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo apt install ruby
sudo gem install asciidoctor asciidoctor-diagram asciidoctor-pdf</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_building_the_documentation">Building the documentation</h3>
<div class="paragraph">
<p>To build the documentation, navigate to the <code>src/docsrc</code> directory and run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>docbuild.sh all</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_diagram_support">Diagram support</h3>
<div class="paragraph">
<p>For diagrams, some additional packages are required.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo apt install graphviz plantuml</code></pre>
</div>
</div>
<div class="paragraph">
<p>For mermaid, rather than use <code>mermaid-cli</code> from the package manager,
I wanted the latest version of mermaid-cli via npm
(after installing nvm for the latest version of nodejs).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash
source ~/.bashrc || source ~/.zshrc
nvm install --lts

npm install -g @mermaid-js/mermaid-cli</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ocr_image_text_extraction_support">OCR image text extraction support</h3>
<div class="paragraph">
<p>For OCR image text extraction, Tesseract and the Python Pillow and pytesseract libraries are required.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo apt install tesseract-ocr
pip install Pillow pytesseract</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_preparing_the_specifications_table">Preparing the specifications table</h4>
<div class="paragraph">
<p>I decided to not make the extraction part of the pipeline and just prep the source beforehand.
To recreate the table preparation process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Extract the text:</p>
<div class="literalblock">
<div class="content">
<pre>pushd src/docsrc/img-extract
python ocr-extract.py &gt; ocr-output.txt
popd</pre>
</div>
</div>
</li>
<li>
<p><em>&#8230;&#8203;&#8230;&#8203;x&#8230;&#8203;&#8230;&#8203;</em></p>
</li>
<li>
<p>Okay, nevermind. ChatGPT did it all for me. I uploaded the image and gave it this prompt:</p>
<div class="literalblock">
<div class="content">
<pre>I will upload an image that is basically a fancy table.
Extract the text from the image and convert it to a table in AsciiDoc.
Let me know when you're ready.</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>But the OCR was a good exercise anyway.</p>
</div>
</div>
<div class="sect3">
<h4 id="_preparing_the_etl_mindmap">Preparing the ETL mindmap</h4>
<div class="paragraph">
<p>Let&#8217;s try ChatGPT again.</p>
</div>
<div class="paragraph">
<p>Well done, ChatGPT! Here&#8217;s the prompt and you can find the source image in this repository
under <code>src/docsrc/img-extract/etl-map.png</code>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>New task: Now I'm going to upload an image of a fancy mindmap diagram.
I'd like you to extract the information from the image and recreate it
using mermaid syntax. Let me know when you're ready.</pre>
</div>
</div>
<div class="paragraph">
<p>I&#8217;ll clean it up with icons and shapes myself.
Can&#8217;t let AI rob me of all the fun!</p>
</div>
<div class="paragraph">
<p>(I later asked ChatGPT to convert to a Drawio file instead, but it had an error about
IDs. After debugging with <code>xmllint</code> and fixing the IDs, I got a valid Drawio file,
but it was only two node levels deep and didn&#8217;t follow the style anyway. So, I&#8217;m
sticking with mermaid for now.)</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_architecture">Data architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before defining the data flow, it&#8217;s essential to establish
clear specifications for each layer in the data pipeline. This ensures
that each layer serves its intended purpose and meets the requirements
of the overall data strategy.</p>
</div>
<div class="sect2">
<h3 id="_etl_task_breakdown">ETL task breakdown</h3>
<div class="paragraph">
<p>These are the tasks in the ETL process. I&#8217;d go over this with stakeholders
to see what&#8217;s required. For this exercise, Baraa wants us to do the tasks
highlighted in pink. (We&#8217;ll do the entire <em>Transformation</em> section and its
subtasks.)</p>
</div>
<div class="imageblock">
<div class="content">
<img src="etl-mindmap.png" alt="etl mindmap" width="1674" height="1044">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_specifications">Specifications</h3>
<div class="paragraph">
<p>Given the chosen tasks in the ETL process, we have the following specifications.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 27.2727%;">
<col style="width: 27.2727%;">
<col style="width: 27.2728%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Category</strong></th>
<th class="tableblock halign-left valign-top"><strong>Bronze Layer</strong></th>
<th class="tableblock halign-left valign-top"><strong>Silver Layer</strong></th>
<th class="tableblock halign-left valign-top"><strong>Gold Layer</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Definition</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raw, unprocessed data as-is from sources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clean &amp; standardized data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business-Ready data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Objective</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Traceability &amp; Debugging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Intermediate Layer) Prepare Data for Analysis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provide data to be consumed for reporting &amp; Analytics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Object Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Views</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Load Method</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full Load (Truncate &amp; Insert)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full Load (Truncate &amp; Insert)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Data Transformation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None (as-is)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Cleaning<br>
Data Standardization<br>
Data Normalization<br>
Derived Columns<br>
Data Enrichment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Integration<br>
Data Aggregation<br>
Business Logic &amp; Rules</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Data Modeling</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None (as-is)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None (as-is)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Star Schema<br>
Aggregated Objects<br>
Flat Tables</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Target Audience</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Engineers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Analysts<br>
Data Engineers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Analysts<br>
Business Users</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_data_flow">Data Flow</h3>
<div class="paragraph">
<p>Looking at the source data we have, this will be the flow to address our specifications.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="data_flow.png" alt="data flow" width="784" height="572">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pipeline">Pipeline</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The ETL pipeline (<code>pipeline.sh</code>) is run with Bash, calling SQL scripts run with psql, with output
to the command line and a log in <code>/tmp/de-dwh-sql</code>.</p>
</div>
<div class="paragraph">
<p>To run the full pipeline:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo -u postgres ./pipeline.sh full</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are other options besides 'full', if you want to run isolated stages of the pipeline.
Here are the stages each option runs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">case $1 in
    "init")
        init_db
        ;;
    "bronze-create")
        bronze_create
        ;;
    "bronze-load")
        bronze_load
        ;;
    "bronze-all")
        bronze_create
        bronze_load
        ;;
    "silver-create")
        silver_create
        ;;
    "silver-load")
        silver_load
        ;;
    "silver-validate")
        silver_validate
        ;;
    "silver-all")
        silver_create
        silver_load
        silver_validate
        ;;
    "gold-create")
        gold_create
        ;;
    "gold-validate")
        gold_validate
        ;;
    "gold-all")
        gold_create
        gold_validate
        ;;
    "full")
        init_db
        bronze_create
        bronze_load
        silver_create
        silver_load
        silver_validate
        gold_create
        gold_validate
        ;;
    *)  echo -ne "\nUsage: $0 {init\n  |bronze-create|bronze-load|bronze-all\n  |silver-create|silver-load|silver-validate|silver-all\n  |gold-create|gold-validate|gold-all|full}\n"
esac</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bronze_layer">Bronze layer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Bronze layer is the initial storage area for raw data ingested from various sources. This layer is designed to store data in its original format, preserving its integrity and providing a foundation for further processing and transformation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_silver_layer">Silver layer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Silver layer serves as the intermediate processing stage in the data pipeline. In this layer, raw data from the Bronze layer is cleaned, transformed, and enriched to enhance its quality and usability for analysis.</p>
</div>
<div class="paragraph">
<p>The key functions of the Silver layer include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data Cleaning: Removing duplicates, handling missing values, and correcting inconsistencies in the data.</p>
</li>
<li>
<p>Data Transformation: Converting data into a more structured format, applying business rules, and aggregating information as needed.</p>
</li>
<li>
<p>Data Enrichment: Integrating additional data sources to provide more context and insights.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By implementing these processes in the Silver layer, we ensure that the data is reliable and ready for advanced analytics and reporting in the subsequent Gold layer.</p>
</div>
<div class="sect2">
<h3 id="_data_integration_analysis_and_sketch">Data integration analysis and sketch</h3>
<div class="imageblock">
<div class="content">
<img src="silver_analysis.png" alt="silver analysis" width="843" height="259">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_coding_the_transformations">Coding the transformations</h3>
<div class="paragraph">
<p>Add metadata columns to track data lineage and help with debugging.
We&#8217;ll add a <code>created</code> column to each silver table. Following the data engineer naming conventions,
and Postgres syntax, we add this column to the create script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">    dwh_created     TIMESTAMP DEFAULT CURRENT_TIMESTAMP;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_crm_customer_info_table">CRM customer info table</h4>
<div class="paragraph">
<p>Next, we gotta check the data quality of the bronze tables.</p>
</div>
<div class="paragraph">
<p>First, we&#8217;ll check for nulls in the primary key columns.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">		select cst_id, count(*) from silver.crm_cust_info
		group by cst_id having count(*) &gt; 1 or cst_id is null</code></pre>
</div>
</div>
<div class="paragraph">
<p>Reveals some duplicates.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="media/dupe-keys-0.png" alt="Duplicate keys found">
</div>
</div>
<div class="paragraph">
<p>Focus on one to see what the problem is.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">select * from bronze.crm_cust_info
where cst_id = '29466';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Results:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="media/dupe-keys-1.png" alt="Duplicate keys example">
</div>
</div>
<div class="paragraph">
<p>This shows that there are multiple entries with different dates.
Since this data warehouse specification doesn&#8217;t need historical data,
we&#8217;ll take the latest.</p>
</div>
<div class="paragraph">
<p>But remember, we leave bronze the same and transform (clean) as we go.
To do this, let&#8217;s grab the latest record per <code>cst_id</code> and rank them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">select *, row_number() over (
	partition by cst_id order by cst_create_date desc
) as flag_last
from bronze.crm_cust_info
where cst_id = 29466;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ll apply this to the whole table to see if this same procedure
flags all duplicates.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">select * from (
    select *, row_number() over (
    	partition by cst_id order by cst_create_date desc
    ) as flag_last
    from bronze.crm_cust_info
) sub
where flag_last != 1;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Checking against the duplicates found earlier, when we change <code>flag_last = 1</code>,
we see that all duplicates are removed.</p>
</div>
<div class="paragraph">
<p>That&#8217;s just one example of data cleaning in the silver layer.
See the <code>src/silver</code> folder for the full SQL scripts.</p>
</div>
<div class="paragraph">
<p>In addition to <strong>removing duplicates in primary keys</strong>, we will do things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Remove unwanted spaces in text fields</strong></p>
</li>
<li>
<p><strong>Data normalization or standardization</strong>, e.g. consistency of values in low cardinality columns</p>
</li>
<li>
<p><strong>Handling missing values appropriately</strong>, e.g. replacing NULLs with 'Unknown' or default values</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_crm_product_info_and_sales_tables">CRM product info and sales tables</h4>
<div class="paragraph">
<p>For the <code>crm_prd_info</code> table, we will, in addition:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Derive new columns</strong>, e.g. extracting category from product codes</p>
</li>
<li>
<p><strong>Data type conversions</strong>, e.g. casting timestamps with <code>00:00:00</code> times to date</p>
</li>
<li>
<p><strong>Data enrichment</strong>, e.g. making sales end dates make sense and not overlap with start dates</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the <code>crm_sales_details</code> table, the sales, quantity, and price columns are tricky.
After doing some quality checks, we discover quite a few places where things don&#8217;t add up.
Before doing <strong>data enrichment</strong>, we would verify with the data owner what to do with these
bad values.</p>
</div>
<div class="paragraph">
<p>The rules Baraa came up with are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If sales is negative, zero, null, or not equal to derived sales from quantity * price, set it to derived value</p>
</li>
<li>
<p>If price is zero or null, derive it from sales / quantity (or null if 0 quantity to prevent div by 0)</p>
</li>
<li>
<p>If prices is negative, set it to absolute value (positive)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_erp_tables">ERP tables</h4>
<div class="paragraph">
<p>In addition to deriving a valid foreign key to <code>crm_cust_info</code>,
there are birthdays that are in the future and as old as 1917!
After consulting the data owner, we decide to set future birthdays
to null and leaving old birthdays as is.</p>
</div>
<div class="paragraph">
<p>For the <code>erp_loc_a101</code> table, besides deriving the foreign key,
we also normalize the country fields.</p>
</div>
<div class="paragraph">
<p>For the <code>erp_px_cat_g1v2</code> table, we already derived a category id
column in the cust_prod_info silver table that matches the id, and
when checking spaces, standardization, and consistency, we find no issues.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gold_layer">Gold layer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Gold layer represents the final stage in the data pipeline, where the data is refined and optimized for business intelligence and analytics,
separated into facts and dimensions.
For this project, the star schema model is sufficient as there are only a couple of product and customer <em>dimensions</em> surrounding the sales orders <em>facts</em>.</p>
</div>
<div class="paragraph">
<p>First step on how to determine how to build our gold data model is to examine the silver data model and add some labels
to group things logically.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="silver_into_categories.png" alt="silver into categories" width="935" height="301">
</div>
</div>
<div class="paragraph">
<p>Referring back to the <a href="#_specifications">Specifications</a>, we see that rather than loading data,
we&#8217;ll be creating views into the cleaned silver tables, views that might aggregate and integrate information.</p>
</div>
<div class="paragraph">
<p>Another thing to add to the views are surrogate keys to use as the primary keys.
TIL that these are exposed in the fact view SELECTs, while it&#8217;s fact view JOINs that create
the links between the relevant columns gold views (rather than using those columns as foreign keys).
Only after JOINing the fact table are the foreign keys resolved.
That&#8217;s why it seemed that the surrogates could be sorted however you want. (I think.)</p>
</div>
<div class="paragraph">
<p>To verify the joins (foreign key integrity) execute joins on the keys and see if any keys are NULL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>SELECT COUNT(*) FROM gold.fact_sales f
LEFT JOIN gold.customers c ON f.customer_key = c.customer_key
LEFT JOIN gold.products c ON f.product_key = c.product_key
WHERE p.product_key IS NULL OR c.customer_key IS NULL;</code></pre>
</div>
</div>
<div class="paragraph">
<p>After coding the gold layer, we end up with this data model of the star schema:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="gold_star.png" alt="gold star" width="427" height="560">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data_catalog">The Data Catalog (gold layer)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview">Overview</h3>
<div class="paragraph">
<p>The Gold Layer is the business-level data representation, structured to support analytical and reporting use cases.
It consists of <strong>dimension tables</strong> and <strong>fact tables</strong> for specific business metrics.</p>
</div>
</div>
<div class="sect2">
<h3 id="_gold_dim_customers">gold.dim_customers</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Purpose:</strong> Stores customer details enriched with demographic and geographic data.</p>
</li>
<li>
<p><strong>Columns:</strong></p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 13.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column Name</th>
<th class="tableblock halign-left valign-top">Data Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">customer_key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Surrogate key uniquely identifying each customer record in the dimension table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">customer_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique numerical identifier assigned to each customer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">customer_number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alphanumeric identifier representing the customer, used for tracking and referencing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">first_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The customer&#8217;s first name, as recorded in the system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">last_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The customer&#8217;s last name or family name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">country</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The country of residence for the customer (See <a href="#_known_countries">Known countries</a>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">marital_status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The marital status of the customer (e.g., 'Married', 'Single').</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gender</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The gender of the customer (Valid values: 'Male', 'Female', 'Unknown').</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">birthdate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The date of birth of the customer, formatted as YYYY-MM-DD. (Oldest possible customer is 115 years old.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">create_date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The date and time when the customer record was created in the system</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_known_countries">Known countries</h4>
<div class="paragraph">
<p>The following countries are currently the only ones that exist in the data.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Australia</p>
</li>
<li>
<p>Canada</p>
</li>
<li>
<p>France</p>
</li>
<li>
<p>Germany</p>
</li>
<li>
<p>United Kingdom</p>
</li>
<li>
<p>United States</p>
</li>
<li>
<p>Unknown</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gold_dim_products">gold.dim_products</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Purpose:</strong> Provides information about the products and their attributes.</p>
</li>
<li>
<p><strong>Columns:</strong></p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 13.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column Name</th>
<th class="tableblock halign-left valign-top">Data Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">product_key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Surrogate key uniquely identifying each product record in the product dimension table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">product_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique identifier assigned to the product for internal tracking and referencing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">product_number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A structured alphanumeric code representing the product, often used for categorization or inventory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">product_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Descriptive name of the product, including key details such as type, color, and size.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">category_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique identifier for the product&#8217;s category, linking to its high-level classification.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">category</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The broader classification of the product (e.g., Bikes, Components) to group related items.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">subcategory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A more detailed classification of the product within the category, such as product type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maintenance_required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the product requires maintenance (Valid values are 'Yes', 'No', 'Unknown').</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cost or base price of the product, measured in monetary units.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">product_line</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The specific product line or series to which the product belongs (e.g., Road, Mountain).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start_date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The date when the product became available for sale or use, stored in.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_gold_facts_sales">gold.facts_sales</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Purpose:</strong> Stores transactional sales data for analytical purposes.</p>
</li>
<li>
<p><strong>Columns:</strong></p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 13.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column Name</th>
<th class="tableblock halign-left valign-top">Data Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">order_number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR(50)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique alphanumeric identifier for each sales order (e.g., 'SO54496').</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">product_key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Surrogate key linking the order to the product dimension table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">customer_key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Surrogate key linking the order to the customer dimension table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">order_date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The date when the order was placed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">shipping_date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The date when the order was shipped to the customer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">due_date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The date when the order payment was due.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sales_amount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The total monetary value of the sale for the line item, in whole currency units (e.g., 25).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quantity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of units of the product ordered for the line item (e.g., 1).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">price</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The price per unit of the product for the line item, in whole currency units (e.g., 25).</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2026-01-28 15:59:37 -0600
</div>
</div>
</body>
</html>